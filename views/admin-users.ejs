<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Gestion Utilisateurs - Admin</title>
  <link rel="stylesheet" href="/css/style.css">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
</head>
<body class="admin-dashboard">
  <header class="admin-header">
    <div class="logo" style="position: absolute; left: 2rem; top: 50%; transform: translateY(-50%);">
      <img src="/images/LOGO_AFRIKMARKET.jpg" alt="AfrikMarket Logo" style="height: 40px;">
    </div>
    <h1><i class="fas fa-users-cog"></i> Gestion des Utilisateurs</h1>
    <nav class="admin-nav">
      <a href="/admin"><i class="fas fa-tachometer-alt"></i> Dashboard</a>
      <a href="/admin/annonces"><i class="fas fa-bullhorn"></i> Gérer Annonces</a>
      <form action="/logout" method="POST" style="display:inline;">
        <button type="submit" class="btn-admin" style="background: rgba(255,255,255,0.2); border: 1px solid rgba(255,255,255,0.3);">
          <i class="fas fa-sign-out-alt"></i> Déconnexion
        </button>
      </form>
    </nav>
  </header>

  <main class="admin-main">
    <div class="admin-table-section">
      <h2><i class="fas fa-users"></i> Liste des Utilisateurs (<%= users.length %>)</h2>
      <table class="admin-table">
        <thead>
          <tr>
            <th><i class="fas fa-user"></i> Nom</th>
            <th><i class="fas fa-envelope"></i> Email</th>
            <th><i class="fas fa-crown"></i> Rôle</th>
            <th><i class="fas fa-calendar"></i> Date d'inscription</th>
            <th><i class="fas fa-cogs"></i> Actions</th>
          </tr>
        </thead>
        <tbody>
          <% users.forEach(user => { %>
            <tr>
              <td>
                <div style="display: flex; align-items: center; gap: 0.5rem;">
                  <div style="width: 32px; height: 32px; border-radius: 50%; background: linear-gradient(135deg, #667eea, #764ba2); display: flex; align-items: center; justify-content: center; color: white; font-weight: bold;">
                    <%= user.name.charAt(0).toUpperCase() %>
                  </div>
                  <%= user.name %>
                </div>
              </td>
              <td><%= user.email %></td>
              <td>
                <% if (user.role === 'admin') { %>
                  <span style="background: linear-gradient(135deg, #667eea, #764ba2); color: white; padding: 0.25rem 0.75rem; border-radius: 20px; font-size: 0.8rem; font-weight: bold;">
                    <i class="fas fa-crown"></i> Administrateur
                  </span>
                <% } else { %>
                  <span style="background: #e9ecef; color: #666; padding: 0.25rem 0.75rem; border-radius: 20px; font-size: 0.8rem;">
                    <i class="fas fa-user"></i> Utilisateur
                  </span>
                <% } %>
              </td>
              <td><%= user.createdAt.toLocaleDateString('fr-FR') %></td>
              <td>
                <% if (user.role !== 'admin') { %>
                  <form action="/admin/users/<%= user._id %>/delete" method="POST" style="display:inline;" onsubmit="return confirm('Êtes-vous sûr de vouloir supprimer cet utilisateur ? Cette action est irréversible.')">
                    <button type="submit" class="btn-admin btn-danger" style="font-size: 0.8rem; padding: 0.4rem 0.8rem;">
                      <i class="fas fa-trash"></i> Supprimer
                    </button>
                  </form>
                <% } else { %>
                  <span style="color: #666; font-style: italic; font-size: 0.9rem;">
                    <i class="fas fa-shield-alt"></i> Protégé
                  </span>
                <% } %>
              </td>
            </tr>
          <% }); %>
        </tbody>
      </table>
    </div>
  </main>

  <footer>
    <p>&copy; 2024 AfrikMarket. Tous droits réservés.</p>
    <a href="/">Accueil</a>
    <a href="/contact">Contact</a>
    <a href="/about">À propos</a>
  </footer>

  <script src="/js/main.js"></script>
</body>
</html>
